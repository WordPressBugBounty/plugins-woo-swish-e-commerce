!function(){"use strict";var e=window.wp.element,t=window.wc.wcBlocksRegistry,n=window.wp.i18n,s=(window.React,window.wc.wcSettings);let o=!1;const a=()=>{const e=(0,s.getSetting)("swish_data",null);if(o||(console.log("swishServerData",e),o=!0),!e)throw new Error("Swish initialization data is not available");return e};window.wp.components;const r={style:{base:{iconColor:"#666EE8",color:"#31325F",fontSize:((e,t,n)=>{let s={};if("object"==typeof document&&"function"==typeof document.querySelector&&"function"==typeof window.getComputedStyle){const e=document.querySelector(".wc-block-checkout");e&&(s=window.getComputedStyle(e))}return s.fontSize||"16px"})(),lineHeight:1.375,"::placeholder":{color:"#fff"}}},classes:{focus:"focused",empty:"empty",invalid:"has-error"}},l=t=>{const{className:n,label:s,id:o,value:r,placeholder:l,onChange:i}=t,[c,m]=React.useState(!1),u=a(),p=u?.mirror_number;return p&&React.useEffect((()=>{const e=document.getElementById("billing-phone");if(e){const t=e.value;if(t&&!r&&!c){const e=t.replace(/\D/g,"");i(e)}const n=e=>{const t=e.target.value.replace(/\D/g,"");i(t),m(!1)};return e.addEventListener("change",n),e.addEventListener("input",n),()=>{e.removeEventListener("change",n),e.removeEventListener("input",n)}}}),[i,r]),(0,e.createElement)("input",{className:n,label:s,id:o,placeholder:l,value:r,onChange:e=>{m(!0),i(e.target.value)}})},i=t=>{let{inputErrorComponent:s,onChange:o,paymentRequestData:i,setPayerAlias:c,payerAlias:m,showWaitModal:u}=t;const[p,w]=(0,e.useState)(!0),{options:h,onActive:d,error:g,setError:y}=(t=>{const[n,s]=(0,e.useState)(!1),[o,a]=(0,e.useState)({...r}),[l,i]=(0,e.useState)("");return(0,e.useEffect)((()=>{const e=n?"#CFD7E0":"#fff";a((t=>({...t,style:{...t.style,base:{...t.style.base,"::placeholder":{color:e}}}})))}),[n]),{options:o,onActive:(0,e.useCallback)((e=>{s(!e||(e=>!e))}),[s]),error:l,setError:i}})(),{logoText:E,logoImage:f,placeholder:b,label:v,m_payment:S,description:R}=a();return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"wc-swish-inline-element",id:"swish-description"},R),!S&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"wc-block-gateway-container wc-inline-card-element"},(0,e.createElement)(l,{id:"wc-swish-inline-element",className:"wc-block-gateway-input",value:m,options:h,placeholder:b,onBlur:()=>d(p),onFocus:()=>d(p),onChange:e=>{w(0===e.length),isNaN(e)?e.length>0&&"+"!=e.charAt(0)||isNaN(e.slice(1))?(y((0,n.__)("Use numbers and + only","woo-swish-e-commerce")),e=e.slice(0,-1)):y(""):e.length>0&&"0"!==e.charAt(0)&&"+"!==e.charAt(0)?(y((0,n.__)("First character in the number must be 0 or +","woo-swish-e-commerce")),e=e.slice(0,-1)):y(""),c(e),o(e)}}),(0,e.createElement)("label",{htmlFor:"wc-swish-inline-element"},v)),(0,e.createElement)(s,{errorMessage:g})))},c=t=>{let{eventRegistration:s,emitResponse:o,billing:a,components:r}=t;const{ValidationInputError:l}=r,[c,m]=(0,e.useState)(""),[u,p]=(0,e.useState)(!1),[w,h]=(0,e.useState)(""),d=((t,s,o,a,r,l,i,c,m)=>{const[u,p]=(0,e.useState)(""),w=(0,e.useCallback)((e=>{var t;const{type:s,code:o="",message:a}=e,r=null!==(t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e===errorTypes.API_ERROR?getMessageString(t):(0,n.__)("Unable to process your Swish payment, please try again or use alternative method.","woo-swish-e-commerce")}(s,o))&&void 0!==t?t:a;return p(r),r}),[]),{onCheckoutFail:h,onPaymentSetup:d}=t;return((t,n)=>{(0,e.useEffect)((()=>n((()=>(console.log("usePaymentProcessing, onPaymentSetup"),{type:"success",meta:{paymentMethodData:{"swish-payer-alias":t}}})))),[n,t])})(l,d),(0,e.useEffect)((()=>h((e=>{let{processingResponse:t}=e;return!t?.paymentDetails?.errorMessage||{type:s.responseTypes.ERROR,message:t.paymentDetails.errorMessage,messageContext:s.noticeContexts.PAYMENTS}}))),[h,s.noticeContexts.PAYMENTS,s.responseTypes.ERROR]),w})(s,o,0,0,0,w);return(0,e.createElement)(i,{showWaitModal:u,id:"swish-number",value:w,paymentRequestData:!0,setPayerAlias:h,payerAlias:w,onChange:e=>{e.error&&d(e),m("")},inputErrorComponent:l})};var m=window.wp.htmlEntities;const u=a(),p={name:"swish",label:(0,e.createElement)((t=>{const{PaymentMethodLabel:s}=t.components,o=a()?.icon,r=a()?.title,l=(0,e.createElement)("img",{src:o,alt:(0,m.decodeEntities)((0,n.__)("Swish","woo-swish-e-commerce")),align:"right"});return(0,e.createElement)("span",{className:"wc-swish-label-container",style:{width:"98%",display:"block"}},(0,e.createElement)(s,{text:r}),l)}),{props:!0}),content:(0,e.createElement)(c,{props:!0}),edit:(0,e.createElement)(c,{props:!0}),canMakePayment:()=>!0,ariaLabel:(0,n.__)("Swish payment method","woo-swish-e-commerce"),supports:{features:u.supports},paymentMethodId:"swish"};(0,t.registerPaymentMethod)(p)}();